[TOC]



# **Rest Framework**：

## RESTful规范   





----

## APIView   







----

## 序列化组件  

``` python

from rest_framework import serializers

```



### 作用

- 反序列化: 将json转成模型类的对象
- 序列化   : 将模型累的对象,转成json
- 作用
  - 反序列化 (校验,入库)
  - 序列化返回

### 定义规则:

1. 定义类, 继承自serializer

2. 和模型类, 字段名字一样

3. 和模型类, 字段类型一样

4. 和模型类, 字段选项一样

**serializers.py**

``` python
from rest_framework import serializers
from booktest import models


# 书籍序列化器
class BookInfoSerializer(serializers.Serializer):
    id = serializers.IntegerField(label="id", read_only=True)
    title = serializers.CharField(max_length=20, label="名称")
    pub_date = serializers.DateField(label="发布日期")
    read = serializers.IntegerField(default=0, label="阅读量")
    comment = serializers.IntegerField(default=0, label="评论量")
    is_delete = serializers.BooleanField(default=False, label="逻辑删除")


# 英雄序列化器
class HeroInfoSerializer(serializers.Serializer):
    GENDER_CHOICES = (
        (0, "male"),
        (0, "female"),
    )
    id = serializers.IntegerField(label="ID", read_only=True)
    name = serializers.CharField(label="名字", max_length=20)
    gender = serializers.ChoiceField(choices=GENDER_CHOICES, label="性别", required=False)
    comment = serializers.CharField(label="描述信息", max_length=200, required=False, allow_null=True)
    # 1. 关联的书籍外键, 主键   (设置read_only=True 或者 设置queryset) 返回的外键的id
    # book = serializers.PrimaryKeyRelatedField(read_only=True)
    # book = serializers.PrimaryKeyRelatedField(queryset=models.Bookinfo.objects.all())

    # 2.关联的书籍, 使用模型类__str__方法返回
    #book = serializers.StringRelatedField(read_only=True)

    # 3.关联的书籍, 使用书籍的序列化器,可以取出所以书籍的详细信息
    book = BookInfoSerializer()
    
    
    
    
 # 写几个序列化几个

```

字段选项

```
label="id" 字段说明
read_only=True
```

### 序列化单个对象

**views.py**

``` python
from booktest.serializers import BookInfoSerializer
from booktest import models

# 序列化单个文件
#1. 获取书籍对象
book = models.Bookinfo.objects.get(id=1)

# 2.创建序列化器, instance, 表示要序列化的对象
serializer = BookInfoSerializer(instance=book)

# 3.转换数据
print(serializer.data)


```

注意点:

 1. BookInfoSerializer(instance=book) 

    instance=book 表示要将book进行序列化

	2. serializer.data 取到序列化的结果



### 序列化列表数据

**views.py**

```python
from booktest.serializers import BookInfoSerializer
from booktest import models
# 序列化多个对象
#1. 获取书籍对象
book = models.Bookinfo.objects.all()

# 2.创建序列化器, instance 表示要序列化的对象, many=True 标识要序列化多个对象
serializer = BookInfoSerializer(instance=book,many=True)

# 3.转换数据
print(serializer.data)

# 返回orderdict
# [{}]
```

注意:

​	BookInfoSerializer(instance=book,many=True) many=True



### 序列化关联外键

**serializers.py**

``` python
# 英雄序列化器
class HeroInfoSerializer(serializers.Serializer):
    GENDER_CHOICES = (
        (0, "male"),
        (0, "female"),
    )
    id = serializers.IntegerField(label="ID", read_only=True)
    name = serializers.CharField(label="名字", max_length=20)
    gender = serializers.ChoiceField(choices=GENDER_CHOICES, label="性别", required=False)
    comment = serializers.CharField(label="描述信息", max_length=200, required=False, allow_null=True)
    
    
    # 1. 关联的书籍外键, 主键   (设置read_only=True 或者 设置queryset) 返回的外键的id
    # book = serializers.PrimaryKeyRelatedField(read_only=True)
    # book = serializers.PrimaryKeyRelatedField(queryset=models.Bookinfo.objects.all())

    # 2.关联的书籍, 使用模型类__str__方法返回
    #book = serializers.StringRelatedField(read_only=True)

    # 3.关联的书籍, 使用书籍的序列化器,可以取出所以书籍的详细信息
    book = BookInfoSerializer()
```



**views.py**

```python
from booktest.serializers import BookInfoSerializer, HeroInfoSerializer
from booktest import models
# 序列化多个对象
hero = models.HeroInfo.objects.all()

# 2.创建序列化器, instance 表示要序列化的对象, many=True 标识要序列化多个对象
serializer = HeroInfoSerializer(instance=hero,many=True)

# 3.转换数据
print(serializer.data)
```



#### 书籍序列化器,反向查找关联many字段

**serializers.py**

``` python
# 书籍序列化器
class BookInfoSerializer(serializers.Serializer):
    id = serializers.IntegerField(label="id", read_only=True)
    title = serializers.CharField(max_length=20, label="名称")
    pub_date = serializers.DateField(label="发布日期")
    read = serializers.IntegerField(default=0, label="阅读量")
    comment = serializers.IntegerField(default=0, label="评论量")
    is_delete = serializers.BooleanField(default=False, label="逻辑删除")

    # 1. 反向查找英雄主键,many=True, 序列化多方,需要加上,只显示id
    # hero_set = serializers.PrimaryKeyRelatedField(read_only=True,many=True)

    # 2. 显示反向模型的__str__
    hero_set = serializers.StringRelatedField(read_only=True, many=True)

```





















----

## 视图组件  
## 解析器   
## 认证组件   
## 权限组件   
## 频率组件   
## 分页器  
## 响应器    
## url控制器   
## 版本控制
## JWT
## celery
```

```